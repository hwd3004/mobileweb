<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="./jquery.mobile-1.4.5/jquery.mobile-1.4.5.min.css"
    />
    <script src="./jquery/jquery.min.js"></script>
    <script src="./jqmobile-1.5/jqmobile-1.5.js"></script>

    <script
      type="text/javascript"
      src="//dapi.kakao.com/v2/maps/sdk.js?appkey=01700d1e9231adf58b094361ccf9807b"
    ></script>

    <title>모바일웹</title>
    <!-- 360 * 640, 4배 해상도 이미지 -->
    <!-- 구글 디바이스 메트릭스 -->
    <!-- 폰트 제일 무난한 건 고딕, 고딕에이원, 지마켓폰트 -->
    <!-- 폰트사이트 눈누 -->
    <!-- 일관성과 가독성 -->
    <!-- 아이콘은 xeicon, freepik -->
    <!-- 미디어쿼리 쓸땐 가로 크기 480으로 -->
  </head>
  <body>
    <div id="map" style="width: 100%; height: 350px"></div>
    <!--  -->
    <script>
      var mapContainer = document.getElementById("map"), // 지도를 표시할 div
        mapOption = {
          center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
          level: 3, // 지도의 확대 레벨
        };

      // 지도를 표시할 div와  지도 옵션으로  지도를 생성합니다
      var map = new kakao.maps.Map(mapContainer, mapOption);
      //
      //
      //
      const COORDS = "coords";

      const handleGeoSuccess = (position) => {
        const latitude = position.coords.latitude;
        const longitude = position.coords.longitude;
        console.log(latitude, longitude);

        const coordsObj = {
          latitude,
          longitude,
        };

        localStorage.setItem(COORDS, JSON.stringify(coordsObj));
      };

      const handleGeoError = () => {
        alert("위치 정보를 불러올 수 없습니다.");
      };

      const loadCoords = () => {
        const loadedCoords = localStorage.getItem(COORDS);
        console.log(loadedCoords);
        if (loadedCoords === null) {
          navigator.geolocation.getCurrentPosition(
            handleGeoSuccess,
            handleGeoError
          );
        }
      };

      const init = () => {
        loadCoords();
      };

      init();
    </script>
  </body>
</html>
